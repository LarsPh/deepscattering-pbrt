
/*
    pbrt source code is Copyright(c) 1998-2016
                        Matt Pharr, Greg Humphreys, and Wenzel Jakob.

    This file is part of pbrt.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

    - Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

    - Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
    IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
    TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
    PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

 */

// tests/hair.cpp*
#include "materials/hair.h"
#include "pbrt.h"
#include "rng.h"
#include "sampling.h"
#include "tests/gtest/gtest.h"

// Hair Tests
#if 0
TEST(Hair, Reciprocity) {
  RNG rng;
  for (int i = 0; i < 10; ++i) {
    Hair h(-1 + 2 * rng.UniformFloat(), 1.55,
           HairBSDF::SigmaAFromConcentration(.3 + 7.7 * rng.UniformFloat()),
           .1 + .9 * rng.UniformFloat(),
           .1 + .9 * rng.UniformFloat());
    Vector3f wi = UniformSampleSphere({rng.UniformFloat(), rng.UniformFloat()});
    Vector3f wo = UniformSampleSphere({rng.UniformFloat(), rng.UniformFloat()});
    Spectrum a = h.f(wi, wo) * AbsCosTheta(wo);
    Spectrum b = h.f(wo, wi) * AbsCosTheta(wi);
    EXPECT_EQ(a.y(), b.y()) << h << ", a = " << a << ", b = " << b << ", wi = " << wi
                    << ", wo = " << wo;
  }
}

#endif
TEST(Hair, Pow) {
    EXPECT_EQ(Pow<0>(2.f), 1 << 0);
    EXPECT_EQ(Pow<1>(2.f), 1 << 1);
    EXPECT_EQ(Pow<2>(2.f), 1 << 2);
    // Test remainder of pow template powers to 29
    EXPECT_EQ(Pow<3>(2.f), 1 << 3);
    EXPECT_EQ(Pow<4>(2.f), 1 << 4);
    EXPECT_EQ(Pow<5>(2.f), 1 << 5);
    EXPECT_EQ(Pow<6>(2.f), 1 << 6);
    EXPECT_EQ(Pow<7>(2.f), 1 << 7);
    EXPECT_EQ(Pow<8>(2.f), 1 << 8);
    EXPECT_EQ(Pow<9>(2.f), 1 << 9);
    EXPECT_EQ(Pow<10>(2.f), 1 << 10);
    EXPECT_EQ(Pow<11>(2.f), 1 << 11);
    EXPECT_EQ(Pow<12>(2.f), 1 << 12);
    EXPECT_EQ(Pow<13>(2.f), 1 << 13);
    EXPECT_EQ(Pow<14>(2.f), 1 << 14);
    EXPECT_EQ(Pow<15>(2.f), 1 << 15);
    EXPECT_EQ(Pow<16>(2.f), 1 << 16);
    EXPECT_EQ(Pow<17>(2.f), 1 << 17);
    EXPECT_EQ(Pow<18>(2.f), 1 << 18);
    EXPECT_EQ(Pow<19>(2.f), 1 << 19);
    EXPECT_EQ(Pow<20>(2.f), 1 << 20);
    EXPECT_EQ(Pow<21>(2.f), 1 << 21);
    EXPECT_EQ(Pow<22>(2.f), 1 << 22);
    EXPECT_EQ(Pow<23>(2.f), 1 << 23);
    EXPECT_EQ(Pow<24>(2.f), 1 << 24);
    EXPECT_EQ(Pow<25>(2.f), 1 << 25);
    EXPECT_EQ(Pow<26>(2.f), 1 << 26);
    EXPECT_EQ(Pow<27>(2.f), 1 << 27);
    EXPECT_EQ(Pow<28>(2.f), 1 << 28);
    EXPECT_EQ(Pow<29>(2.f), 1 << 29);
}

TEST(Hair, WhiteFurnace) {
    RNG rng;
    Vector3f wo = UniformSampleSphere({rng.UniformFloat(), rng.UniformFloat()});
    for (Float beta_m = .1; beta_m < 1; beta_m += .2) {
        for (Float beta_n = .1; beta_n < 1; beta_n += .2) {
            // Estimate reflected uniform incident radiance from hair
            Spectrum sum = 0.f;
            int count = 300000;
            for (int i = 0; i < count; ++i) {
                Float h = -1 + 2. * rng.UniformFloat();
                Spectrum sigma_a = 0.f;
                HairBSDF hair(h, 1.55, sigma_a, beta_m, beta_n, 0.f);
                Vector3f wi = UniformSampleSphere(
                    {rng.UniformFloat(), rng.UniformFloat()});
                sum += hair.f(wo, wi) * AbsCosTheta(wi);
            }
            Float avg = sum.y() / (count * UniformSpherePdf());
            EXPECT_TRUE(avg >= .95 && avg <= 1.05);
        }
    }
}

TEST(Hair, WhiteFurnaceSampled) {
    RNG rng;
    Vector3f wo = UniformSampleSphere({rng.UniformFloat(), rng.UniformFloat()});
    for (Float beta_m = .1; beta_m < 1; beta_m += .2) {
        for (Float beta_n = .1; beta_n < 1; beta_n += .2) {
            Spectrum sum = 0.f;
            int count = 300000;
            for (int i = 0; i < count; ++i) {
                Float h = -1 + 2. * rng.UniformFloat();
                Spectrum sigma_a = 0.f;
                HairBSDF hair(h, 1.55, sigma_a, beta_m, beta_n, 0.f);

                Vector3f wi;
                Float pdf;
                Point2f u = {rng.UniformFloat(), rng.UniformFloat()};
                Spectrum f = hair.Sample_f(wo, &wi, u, &pdf, nullptr);
                if (pdf > 0) sum += f * AbsCosTheta(wi) / pdf;
            }
            Float avg = sum.y() / count;
            EXPECT_TRUE(avg >= .99 && avg <= 1.01) << avg;
        }
    }
}

TEST(Hair, SamplingWeights) {
    RNG rng;
    for (Float beta_m = .1; beta_m < 1; beta_m += .2)
        for (Float beta_n = .4; beta_n < 1; beta_n += .2) {
            int count = 10000;
            for (int i = 0; i < count; ++i) {
                // Check _HairBSDF::Sample\_f()_ sample weight
                Float h = -1 + 2 * rng.UniformFloat();
                Spectrum sigma_a = 0;
                HairBSDF hair(h, 1.55, sigma_a, beta_m, beta_n, 0.f);
                Vector3f wo = UniformSampleSphere(
                    {rng.UniformFloat(), rng.UniformFloat()});
                Vector3f wi;
                Float pdf;
                Point2f u = {rng.UniformFloat(), rng.UniformFloat()};
                Spectrum f = hair.Sample_f(wo, &wi, u, &pdf, nullptr);
                if (pdf > 0) {
                    // Verify that hair BSDF sample weight is close to 1 for
                    // _wi_
                    EXPECT_GT(f.y() * AbsCosTheta(wi) / pdf, 0.999);
                    EXPECT_LT(f.y() * AbsCosTheta(wi) / pdf, 1.001);
                }
            }
        }
}

TEST(Hair, SamplingConsistency) {
    RNG rng;
    for (Float beta_m = .2; beta_m < 1; beta_m += .2)
        for (Float beta_n = .4; beta_n < 1; beta_n += .2) {
            // Declare variables for hair sampling test
            const int count = 64 * 1024;
            Spectrum sigma_a = .25;
            Vector3f wo =
                UniformSampleSphere({rng.UniformFloat(), rng.UniformFloat()});
            auto Li = [](const Vector3f &w) -> Spectrum { return w.z * w.z; };
            Spectrum fImportance = 0, fUniform = 0;
            for (int i = 0; i < count; ++i) {
                // Compute estimates of scattered radiance for hair sampling
                // test
                Float h = -1 + 2 * rng.UniformFloat();
                HairBSDF hair(h, 1.55, sigma_a, beta_m, beta_n, 0.f);
                Vector3f wi;
                Float pdf;
                Point2f u = {rng.UniformFloat(), rng.UniformFloat()};
                Spectrum f = hair.Sample_f(wo, &wi, u, &pdf, nullptr);
                if (pdf > 0)
                    fImportance += f * Li(wi) * AbsCosTheta(wi) / (count * pdf);
                wi = UniformSampleSphere(u);
                fUniform += hair.f(wo, wi) * Li(wi) * AbsCosTheta(wi) /
                            (count * UniformSpherePdf());
            }
            // Verify consistency of estimated hair reflected radiance values
            Float err = std::abs(fImportance.y() - fUniform.y()) / fUniform.y();
            EXPECT_LT(err, 0.05);
        }
}

TEST(Hair, Values) {
    static const Float v[][19] = {
        {0.188592672, 0.328442425, 0.89984256, 1.91838467, -0.694385648,
         -0.31382218, -0.647567868, 0.918543816, -0.386479706, 0.0831304193,
         0.177625149, 0.211694106, 0.457679778, 0.334514886, 0.732259095,
         0.68072629, 0.0202064905, 0.894703388, 0.259187698},
        {-0.399348676, 0.127242625, 0.976029396, 7.62616253, 0.223819464,
         0.927551568, -0.299253941, -0.17922616, -0.420877069, 0.889235914,
         0.0307045821, 0.574939311, 0.335017979, 0.000118835596, 0.0835029781,
         -0.696491838, -0.712689519, 0.000495489978, 0.00743596023},
        {0.382115245, 0.802130699, 0.714428425, 4.56835985, -0.581898332,
         0.73312062, -0.352034688, 0.618360341, 0.785616875, 0.020896554,
         0.226571053, 0.088295877, 0.893076241, 0.825309336, 0.0968284011,
         0.854030311, -0.511132598, 0.0175269432, 0.16707103},
        {-0.535857797, 0.375488698, 0.161958963, 0.841054976, -0.0771481469,
         -0.388827413, -0.918074846, -0.389181107, 0.00510564074, 0.921147108,
         0.1065512, 0.414174885, 0.879156649, 0.521968007, -0.246417955,
         -0.0747295693, 0.966278255, 0.397842914, 1.62222183},
        {-0.724376976, 0.960086584, 0.684480608, 3.69438791, -0.852844656,
         -0.51516825, -0.0851924419, 0.0165030193, 0.994261205, -0.105698705,
         0.101143472, 0.0640971884, 0.138526186, 0.601046324, -0.430560857,
         -0.0973653197, -0.897294462, 0.0427682474, 0.230084807},
        {0.764227986, 0.944673955, 0.843218327, 4.99532604, 0.0766092092,
         0.117550351, -0.990107536, 0.0657122657, -0.803177297, 0.592104852,
         0.0162731204, 0.147999808, 0.927715302, 0.604029298, -0.0342855416,
         -0.0345796086, -0.998813689, 0.00430750987, 0.0660849288},
        {0.807001948, 0.132474065, 0.775621176, 4.67892838, 0.831466317,
         -0.546422243, -0.100430965, -0.769128799, -0.447510362, 0.45626229,
         0.409138143, 0.976134419, 0.473638773, 0.346470207, -0.80881393,
         0.24095498, 0.53643328, 0.849343896, 2.38245273},
        {-0.0232974887, 0.766139805, 0.919258654, 5.53591776, -0.430875897,
         0.702395558, -0.566556692, -0.147233874, -0.557429731, 0.817064464,
         0.0024264981, 0.0418854281, 0.749579906, 0.400058955, -0.106114745,
         -0.676850438, 0.728432, 0.00252885441, 0.03891702},
        {-0.856760681, 0.240016654, 0.519844711, 2.46273708, -0.549477935,
         0.83086127, -0.0879976749, 0.526159525, -0.817962229, 0.232581079,
         0.162493199, 0.284336865, 0.171015173, 0.366575539, 0.554185271,
         -0.288412333, 0.780830979, 0.300960094, 1.76802993},
        {0.14132762, 0.271599352, 0.205675691, 6.79609251, -0.842807949,
         0.443981946, 0.304228306, -0.373863906, -0.75819391, -0.534198284,
         4.14924546e-24, 2.53467115e-23, 0.531694412, 0.499558568, 0.80943054,
         0.550960481, 0.203137308, 4.20461941, 9.76712036},
        {0.85375452, 0.490927607, 0.840680242, 3.49218512, -0.381518692,
         0.920518816, 0.0841936469, -0.00860914961, -0.463375092, 0.886120439,
         0.00459445128, 0.0385575853, 0.49714911, 0.19862482, -0.183584392,
         -0.522553921, -0.832606912, 0.0201547891, 0.158928484},
        {-0.787620008, 0.78426367, 0.727224469, 4.8372798, -0.875122845,
         -0.26963383, -0.401817918, -0.968057036, -0.250729233, 0.000544071198,
         0.785048842, 0.00195475761, 0.990828097, 0.895279825, 0.62706542,
         0.437939167, 0.644203603, 0.0319859646, 0.0943024829},
        {0.896090031, 0.444982678, 0.511366606, 6.54953909, 0.146141902,
         -0.611646831, 0.777515709, 0.939245462, -0.220303938, -0.26321876,
         2.54401748e-05, 5.52486563e-05, 0.44743672, 0.891399324, -0.067327857,
         0.986568034, -0.148830518, 0.564789772, 0.6935274},
        {-0.149015367, 0.707586884, 0.460912585, 0.503437757, -0.600851893,
         0.232701004, -0.76473999, 0.641398013, -0.766689539, -0.0282094479,
         0.349373043, 0.0274057277, 0.888465703, 0.988304973, 0.68473953,
         -0.526286006, 0.504137695, 0.414247304, 0.580719173},
        {0.719594479, 0.768229902, 0.652405858, 6.60294676, 0.845425069,
         -0.179514483, -0.503021955, 0.425022513, -0.888154685, -0.174748659,
         0.116881169, 0.128316298, 0.271395087, 0.368460238, -0.718552291,
         0.208608419, 0.663449466, 0.012386593, 0.0516277514},
        {0.42046833, 0.420912087, 0.237520903, 4.79040051, 0.572118938,
         -0.224204794, -0.788931012, -0.555864871, -0.800095618, -0.225524306,
         0.387309074, 1.61316824, 0.294044197, 0.541996062, -0.331532329,
         -0.898695707, -0.287110358, 0.314930767, 1.66990757},
        {-0.0465506911, 0.804507971, 0.997935951, 2.73962092, 0.562375724,
         -0.105492316, 0.820124924, 0.999232233, 0.0325490125, 0.0218066573,
         0.111691192, 0.0468282066, 0.423551977, 0.454948813, -0.56453073,
         0.298428386, 0.76957494, 0.00703212526, 0.104048759},
        {-0.825638771, 0.308107704, 0.666304231, 5.25465107, -0.536064625,
         -0.414369047, -0.735481501, 0.602933228, 0.797573328, -0.0186640024,
         4.98716402, 0.880255997, 0.22772339, 0.753348112, 0.245358795,
         0.942065358, -0.228717864, 0.220381126, 0.476677954},
        {0.525451183, 0.678549886, 0.642640352, 1.67092729, 0.553196728,
         -0.577804863, 0.600095809, -0.593750536, 0.804414511, 0.019431591,
         0.410199255, 0.0920907483, 0.00199941616, 0.541654408, 0.50300914,
         0.856684685, -0.114338249, 0.0156289972, 0.0206459779},
        {0.890884042, 0.483962059, 0.156377852, 8.08101082, 0.711389482,
         -0.572396934, 0.407782853, -0.233056575, 0.620222509, -0.749005079,
         5.40585198e-12, 2.03634592e-11, 0.783706725, 0.245888069, -0.997693539,
         0.0636295974, 0.0236409102, 53.4985085, 6.36075306},
        {0.265627742, 0.339766651, 0.950833678, 0.510927916, -0.868834615,
         -0.487561792, -0.0860809088, -0.000131724722, -0.84228003, 0.539040208,
         0.00168109022, 0.00260881009, 0.358293653, 0.640324414, 0.930680394,
         0.00833314285, -0.365738392, 0.557906687, 0.587438464},
        {0.347066402, 0.25939393, 0.633679807, 6.6382699, 0.676406682,
         0.393165529, 0.622812033, -0.68946588, -0.721744478, -0.0610052347,
         0.00400052359, 0.00413912302, 0.969712079, 0.459755063, -0.692595482,
         0.260145605, 0.672782063, 0.0432651751, 0.493670583},
        {0.100066781, 0.498705655, 0.306756735, 2.80688453, 0.293129176,
         -0.238231525, 0.925916314, -0.882732093, 0.323075354, 0.341183722,
         0.00068338454, 0.00468885247, 0.267230123, 0.234746233, -0.709163308,
         0.271658152, 0.650606871, 0.00916646048, 0.119931556},
        {-0.0205203295, 0.618910611, 0.667432725, 7.18992949, -0.525143504,
         0.823555112, -0.214432478, 0.766581833, 0.641237319, 0.0341601372,
         0.575740099, 0.40476352, 0.812589943, 0.49244386, 0.215434641,
         0.955374658, -0.202106833, 0.0827684179, 0.344271332},
        {-0.918113112, 0.508310795, 0.632055879, 0.464094818, 0.418250561,
         -0.832710147, 0.362850249, -0.41773206, 0.854579568, 0.308534861,
         0.795768082, 0.486994565, 0.973975301, 0.000853049336, 0.340404034,
         0.0344923548, 0.939646363, 0.00594282104, 0.0110761905},
        {-0.826038122, 0.422474712, 0.17993933, 5.17632723, 0.790902436,
         -0.05234465, -0.609699488, -0.0879391432, 0.96354413, 0.252684295,
         0.741596103, 1.05423582, 0.359002143, 0.994705975, -0.638014793,
         0.750549555, 0.172082826, 4.29456139, 4.15765429},
        {0.0852696896, 0.546427786, 0.506458879, 4.07524061, -0.776148617,
         0.619194329, 0.119129062, -0.218241557, 0.799192369, -0.560055494,
         0.00849255919, 0.070697166, 0.678817093, 0.0578066967, 0.30132401,
         0.748289168, 0.590988219, 0.0200201385, 0.175864562},
        {-0.918333769, 0.164274961, 0.843175292, 2.15198898, -0.398064673,
         0.449906796, -0.799455047, 0.37746039, -0.171884641, 0.909933686,
         0.186507612, 0.931948364, 0.488690704, 0.109814599, 0.453854412,
         -0.862446427, 0.224058852, 0.376538932, 0.463294953},
        {0.746560812, 0.78213203, 0.950163722, 3.80672932, -0.735188246,
         0.0612452142, 0.675090551, 0.617091119, -0.748364568, -0.243205905,
         0.0411601551, 0.0861893296, 0.638408959, 0.971998632, 0.930830479,
         -0.0505153053, 0.361943156, 0.0391333513, 0.121952273},
        {-0.630149484, 0.918204963, 0.969346642, 0.524032056, -0.564932466,
         0.689603209, -0.453099012, -0.697701931, 0.715195954, 0.0413116217,
         0.433855057, 0.0473902486, 0.0383194797, 0.620819449, -0.0472542495,
         0.398703605, -0.915861607, 0.0314929672, 0.0762632713},
        {0.914856911, 0.816141427, 0.75268507, 2.51760268, 0.0735332444,
         0.0750236139, 0.994466841, 0.957103729, -0.289392769, 0.0142887831,
         0.16077809, 0.0150789721, 0.475452423, 0.602501571, -0.215138733,
         0.544187605, -0.810910046, 0.0407210886, 0.216741323},
        {0.992372751, 0.556406617, 0.585891902, 1.23102093, 0.648397088,
         -0.719050288, -0.250095963, 0.471988618, 0.7953915, 0.380235612,
         0.205076173, 0.127044797, 0.540881813, 0.790403426, -0.660512269,
         0.468622237, 0.586614668, 0.550054431, 0.525711179},
        {0.496608734, 0.821744859, 0.664066613, 0.506936073, -0.766884863,
         -0.556162298, 0.320267379, 0.847586334, 0.50088197, -0.175255656,
         0.604397357, 0.294038087, 0.911335409, 0.755266488, 0.262430578,
         0.946504295, -0.187775895, 0.205650344, 0.107195944},
        {-0.761933863, 0.721707642, 0.968698084, 4.23381519, -0.856575012,
         0.419728577, 0.300178587, -0.811249554, -0.478485316, -0.33604455,
         0.0180789419, 0.0326250494, 0.250081301, 0.472898424, 0.518152833,
         0.603102446, -0.606452942, 0.0272466186, 0.0887342095},
        {-0.943369627, 0.192557976, 0.771023035, 0.596668482, 0.741173983,
         0.376098096, 0.556067824, -0.711546957, -0.427429169, -0.557678461,
         0.7759884, 0.924342036, 0.322542787, 0.0429245159, -0.720081329,
         -0.24482286, -0.649264693, 0.630899787, 0.874934971},
        {0.549587131, 0.956572056, 0.862199068, 4.50996494, 0.850701809,
         -0.522734702, -0.0552697182, 0.899412811, 0.433916181, 0.0526624322,
         0.104000747, 0.0451928899, 0.851938546, 0.603728831, 0.301160485,
         -0.879217923, 0.369158775, 0.0430342704, 0.131087229},
        {0.304237604, 0.94963032, 0.866267264, 4.11296368, 0.143522099,
         -0.658784747, 0.738514781, -0.767167807, -0.194997326, 0.611088872,
         0.0118542844, 0.15396221, 0.978594244, 0.360518932, 0.22264345,
         -0.53382349, -0.815758765, 0.00180066179, 0.0312196892},
        {-0.285335124, 0.228751332, 0.110845193, 0.586721241, 0.803335786,
         0.329461902, 0.496091247, 0.275206864, -0.782431483, -0.558625221,
         8.09632354e-07, 1.50513574e-06, 0.150259361, 0.380114913, -0.795912266,
         0.0161497947, 0.605196595, 3.35354829, 6.75411797},
        {0.179450989, 0.860469401, 0.857402325, 3.05835128, -0.961178362,
         -0.135918945, -0.240129709, -0.855003417, -0.517452419, 0.0348156691,
         0.585866094, 0.0825366452, 0.264108509, 0.589131117, -0.127085477,
         -0.606604457, 0.784780443, 0.019433111, 0.0617112443},
        {0.968878746, 0.309641719, 0.187681228, 0.768268704, -0.10139817,
         -0.994251311, -0.0343911648, 0.424438983, -0.6666767, 0.612693727,
         0.000197428817, 0.000269748387, 0.591132939, 0.996737242, 0.205981433,
         0.834423006, 0.511184633, 2.93758154, 3.34866977},
        {0.82022059, 0.556739748, 0.189553276, 2.88351417, -0.922941685,
         -0.0224210601, -0.384286284, 0.00441699103, 0.267924607, 0.963429749,
         3.86585104e-11, 1.18222265e-10, 0.735071003, 0.703083873, 0.749317169,
         -0.636004984, 0.184449017, 3.25853682, 1.90778923},
        {-0.88911432, 0.817980886, 0.947888672, 1.99689829, 0.208870038,
         -0.771224618, 0.601320148, -0.045342233, -0.930327952, -0.363914728,
         0.0353770889, 0.0884299427, 0.503466189, 0.314815462, 0.486153543,
         0.195898339, -0.851632893, 0.0146395965, 0.0856365338},
        {-0.937233269, 0.29071635, 0.70228529, 4.87252235, 0.830718398,
         0.31448108, -0.459356666, -0.372502118, -0.265202433, -0.889331102,
         0.000411113142, 0.00102345692, 0.203850538, 0.962181151, -0.80171001,
         0.322854221, 0.503017068, 0.743502557, 1.04691148},
        {-0.99860096, 0.930882931, 0.630732596, 0.895755827, -0.054946363,
         -0.312725455, 0.948252976, 0.525650859, 0.514519513, 0.677466512,
         0.0102883913, 0.00912007969, 0.583176851, 0.417396396, -0.962164342,
         0.0625441149, -0.265194297, 0.858446836, 0.297879666},
        {0.822648883, 0.350713521, 0.714115202, 7.14131832, 0.719918609,
         -0.156366304, -0.676215053, 0.937935114, 0.32748425, 0.114157081,
         8.2840711e-07, 6.55151666e-07, 0.29060027, 0.503040612, -0.97617662,
         -0.0654524043, 0.20686999, 0.237935394, 0.340998143},
        {-0.380302966, 0.918339729, 0.142555431, 1.97523522, -0.352388263,
         0.50241667, 0.789556861, -0.129260868, -0.169597641, 0.97699964,
         0.119452462, 1.77499831, 0.249948218, 0.219293997, -0.827668369,
         -0.118498705, 0.548564613, 0.261300176, 2.18009782},
        {0.953930616, 0.240011826, 0.899561167, 1.85062134, -0.743064284,
         -0.660521686, 0.107548177, 0.808857262, -0.208956614, -0.549624443,
         0.17002058, 0.262384564, 0.637892485, 0.95649606, 0.755109668,
         -0.201205879, 0.623959601, 0.267549336, 0.468738973},
        {-0.91406858, 0.796288192, 0.890079618, 3.35682011, -0.0190255269,
         0.991406262, -0.129428387, -0.337658644, -0.935960889, -0.0998193026,
         0.151970685, 0.107251152, 0.0159392152, 0.385283172, -0.599620819,
         0.490711719, -0.632184267, 0.00532278558, 0.0237908643},
        {-0.736780047, 0.993120968, 0.462485909, 2.65570378, 0.945941985,
         0.297460288, -0.129271746, -0.947582781, 0.317616552, 0.0347366333,
         0.161165372, 0.0176814031, 0.645316482, 0.382988989, -0.179984719,
         0.0363677926, 0.982996881, 0.120778792, 0.374973059},
        {0.728487968, 0.620518982, 0.326971084, 4.47968578, 0.160061419,
         -0.352358401, 0.922075868, 0.159228727, 0.983225644, -0.0889581442,
         0.136106715, 0.198786736, 0.743013382, 0.342226207, 0.00911307335,
         0.749420226, 0.662031949, 0.016190296, 0.175976977},
        {0.448502541, 0.671835721, 0.353048891, 7.73942518, -0.402191192,
         0.914049983, -0.0524870157, 0.700136125, -0.311456978, -0.642498136,
         0.000371245202, 0.00478977244, 0.517442405, 0.336063027, 0.707682431,
         0.3963539, -0.584883869, 0.0927042589, 1.08880866},
        {-0.16136992, 0.228077888, 0.764959455, 3.16384697, 0.757741511,
         0.020300502, 0.652238965, 0.200477511, 0.439836115, 0.875415862,
         3.6619025e-07, 4.89758077e-06, 0.572499156, 0.492369384, -0.818791866,
         -0.294457823, 0.492822945, 0.156751484, 1.18022013},
        {0.539087176, 0.506052732, 0.892359734, 7.12410069, -0.619367599,
         -0.240164101, -0.74746573, -0.631121397, -0.775641561, 0.00812041759,
         0.190739512, 0.0247981697, 0.916355789, 0.355994344, 0.651102543,
         0.711812794, -0.263416052, 0.0160731487, 0.0677865967},
        {0.736418366, 0.186837971, 0.332547635, 6.03895807, 0.399478555,
         -0.114450581, -0.909570217, -0.392354906, -0.244945869, -0.886599779,
         2.6002841e-05, 0.000336424768, 0.607328117, 0.295681387, -0.38074556,
         -0.921425343, 0.0775123313, 3.43958521, 3.89059758},
        {0.213783622, 0.256700158, 0.947937012, 1.26349926, -0.585292399,
         -0.00983956829, 0.810762584, 0.679257154, 0.730317533, -0.0724300146,
         0.581734359, 0.378816366, 0.863332748, 0.627282917, 0.609161139,
         0.377844363, -0.697249115, 0.0864832774, 0.542132676},
        {0.694388747, 0.587895274, 0.140132308, 3.34990239, 0.170914724,
         -0.289474159, 0.941802979, -0.794005394, 0.563069999, 0.229145169,
         0.528953612, 2.04664564, 0.825043559, 0.0797749534, 0.701010942,
         0.670756757, 0.242216855, 0.510789216, 2.08910561},
        {0.475341439, 0.366648525, 0.203647107, 4.4513278, -0.729286849,
         0.650912285, 0.210841179, 0.981383324, 0.153881297, -0.114922881,
         2.58697796, 4.14267635, 0.723880172, 0.0704175606, 0.954017282,
         0.255461693, -0.156813115, 1.00491309, 2.19579935},
        {0.663383484, 0.915578306, 0.663146794, 6.86341381, -0.0453661382,
         0.98403734, -0.172082543, 0.998974025, -0.0357492641, -0.0278009176,
         0.240972355, 0.124384448, 0.977633417, 0.669740975, 0.648470283,
         0.702596843, -0.29299137, 0.0114332652, 0.062196333},
        {-0.840061665, 0.573248982, 0.840028405, 1.37467921, -0.962862134,
         -0.0826800019, 0.25702256, 0.819359422, -0.572305799, -0.0334075689,
         5.49438953, 0.396305352, 0.0668095946, 0.406525135, 0.530415654,
         0.284213722, 0.798675001, 0.0177405402, 0.0305916239},
        {0.131972909, 0.227792293, 0.503707469, 2.00590181, 0.437606186,
         0.768368721, 0.467022836, -0.588071942, 0.774110734, 0.234358549,
         0.29324764, 1.11597407, 0.146065071, 0.0825602934, -0.186946571,
         0.982352138, 0.00593544729, 5.23906898, 0.504947603},
        {0.975230336, 0.590511024, 0.939982414, 2.29399848, 0.628826022,
         0.367949367, -0.684975266, -0.436604172, 0.852640331, -0.287021399,
         0.113668531, 0.0807699561, 0.28036651, 0.804816544, -0.64861393,
         0.739534378, 0.179969147, 0.260723054, 0.116164312},
        {0.124726892, 0.674758673, 0.474793613, 0.70974797, 0.465592772,
         0.473523617, 0.747662187, -0.750376344, -0.534477293, -0.388933539,
         0.354575604, 0.539481282, 0.83594805, 0.277310431, -0.195441961,
         -0.553801656, -0.809386253, 0.207177743, 0.655980945},
        {0.692736387, 0.257340193, 0.874265254, 1.27114117, -0.157346278,
         0.56637162, -0.808990359, 0.131175518, 0.738075674, 0.661843896,
         0.112289324, 0.504223108, 0.184529468, 0.263138145, 0.360873997,
         -0.809046388, -0.463911504, 0.0566080883, 0.17817314},
        {-0.555016756, 0.900040984, 0.706441998, 5.35016918, 0.548445463,
         0.696025848, 0.463417292, -0.984742224, -0.167146221, 0.0484242439,
         0.126740947, 0.104971088, 0.0171980727, 0.513324022, -0.0835403502,
         0.989995837, -0.113706604, 0.0112208584, 0.0218223613},
        {0.951715112, 0.809555352, 0.645329773, 4.82907486, -0.955099642,
         -0.248395517, 0.161506295, 0.648618579, -0.662128329, 0.375339806,
         0.00590373483, 0.00366037781, 0.437814385, 0.882486284, 0.564174652,
         0.758562922, -0.32602033, 0.57320857, 0.308696568},
        {-0.367598176, 0.382061779, 0.520450711, 8.04773998, -0.386990428,
         -0.7766487, 0.497046411, 0.705879569, 0.410815328, -0.577031016,
         0.000226575154, 0.0027021952, 0.995767295, 0.793065667, 0.219312027,
         0.507734835, -0.833131254, 0.000245262461, 0.00422327872},
        {-0.178533256, 0.332260102, 0.931209743, 6.63525629, 0.963426173,
         -0.040445026, 0.264904141, -0.759451091, 0.110338733, 0.64113915,
         0.110936821, 0.277857274, 0.025312122, 0.573009312, -0.929607689,
         0.36293748, -0.0640776157, 2.17243242, 0.543808997},
        {-0.100700378, 0.773503244, 0.179228052, 6.05703545, 0.00584047614,
         -0.999363661, 0.0351861715, -0.223781973, -0.96470201, -0.138822556,
         0.780953705, 2.33010459, 0.777579725, 0.423413306, -0.60896033,
         -0.779969275, -0.144274876, 0.728950679, 2.26036906},
        {-0.876048684, 0.93993783, 0.685306609, 6.40181494, 0.722685516,
         0.4738805, 0.503152907, 0.99610877, -0.0672078952, 0.0570132136,
         0.584670246, 0.178340375, 0.470138699, 0.0433849916, 0.708556056,
         -0.648655713, 0.277838171, 0.157431945, 0.234017238},
        {-0.768867493, 0.792453051, 0.958859384, 6.67337322, 0.0404955149,
         -0.869757056, -0.491815805, 0.757291794, 0.652333021, 0.0311559439,
         0.17584382, 0.0835403576, 0.908670127, 0.962179959, 0.109729044,
         -0.064961642, 0.991836488, 0.00468785642, 0.0708994269},
        {0.644124866, 0.214714408, 0.585906625, 1.93215096, -0.883783579,
         -0.0172021184, 0.467579663, 0.685804605, 0.726893842, 0.0360187888,
         2.69533038, 0.553813517, 0.25308153, 0.63685286, 0.884571731,
         0.291558295, -0.364042073, 0.245866954, 0.510592222},
        {0.981922746, 0.416755855, 0.988376379, 0.521356702, -0.212546676,
         -0.318250507, -0.92387259, -0.439881653, -0.897914112, 0.0159484744,
         1.45402765, 0.0399763808, 0.929273784, 0.921640396, 0.42108202,
         -0.6980322, 0.57917273, 0.151232764, 0.150996074},
        {-0.0533618927, 0.161542207, 0.150568977, 6.3178978, -0.583035529,
         0.450429529, -0.676152945, -0.0418353081, 0.739001989, -0.672403097,
         2.99937255e-06, 4.02482437e-05, 0.473172694, 0.683148086, 0.776127279,
         0.394645303, -0.491814584, 0.373058081, 3.66154718},
        {-0.708176732, 0.80119288, 0.849222362, 3.10277724, -0.0957370028,
         0.340652466, -0.935302258, 0.809981644, -0.586332142, 0.0120148063,
         0.116624117, 0.0228887349, 0.124841109, 0.920305848, 0.911108494,
         0.358557165, -0.203268349, 0.0351750962, 0.116794318},
        {-0.152201414, 0.703825295, 0.9014709, 1.58766448, -0.997730494,
         0.0278721303, -0.0612933636, 0.655128539, 0.450788021, 0.606297612,
         0.140697405, 0.123347521, 0.418506622, 0.383389205, 0.481909543,
         0.467955828, -0.740797222, 0.167073056, 0.178963408},
        {-0.753944099, 0.546522856, 0.387616605, 0.515690565, -0.161704555,
         -0.43572408, -0.885435581, -0.692760587, 0.714719057, 0.0962259173,
         0.0778536871, 0.0175568052, 0.486925155, 0.711199403, 0.311179161,
         -0.180743039, 0.933005631, 0.609164596, 1.33196628},
        {-0.800696194, 0.24678418, 0.561585426, 6.2310648, 0.464853376,
         0.426243246, 0.776033521, -0.576910436, -0.694284558, 0.430282712,
         0.210880488, 1.02969432, 0.479632616, 0.708250105, -0.424915165,
         -0.878034711, 0.220231846, 0.582243562, 1.45513332},
        {0.451442957, 0.413179934, 0.841247916, 1.98111737, 0.458937168,
         -0.459838063, -0.76021421, -0.283109426, -0.953737676, 0.101160228,
         0.170448601, 0.254925191, 0.818580806, 0.917864621, -0.234939083,
         0.698062062, 0.676397026, 0.0122354655, 0.122357808},
        {0.21304214, 0.395870239, 0.65611285, 2.24298739, -0.272392184,
         -0.563565552, -0.779869437, 0.144502833, 0.98948276, -0.00653839111,
         0.71525085, 0.082416296, 0.781303287, 0.847770572, 0.0975949615,
         -0.730868399, -0.675504684, 0.0344912857, 0.41060245},
        {-0.908349276, 0.600578308, 0.272158295, 5.96739817, 0.744783819,
         -0.232058644, 0.625656366, 0.101044901, -0.440676719, -0.89196074,
         0.228098959, 0.85355556, 0.822886467, 0.211692005, -0.664590657,
         -0.330697179, -0.670043707, 0.764499545, 2.14903545},
        {-0.412317097, 0.124263071, 0.220822841, 3.86816597, -0.652829587,
         0.744541705, 0.139539063, -0.901103437, -0.430516988, -0.051651001,
         5.30542793e-26, 4.62527145e-26, 0.362274081, 0.665088952, 0.814486027,
         0.348694056, 0.463707894, 0.100057378, 0.783126056},
        {-0.840805173, 0.829969227, 0.844301164, 2.26387167, -0.849641562,
         0.509324074, 0.136741281, -0.932931364, -0.345564783, -0.101114035,
         0.128339455, 0.0551940762, 0.894250691, 0.853972316, 0.574902296,
         -0.808545887, -0.125462562, 0.269135237, 0.143616959},
        {0.587362885, 0.481798351, 0.996000111, 3.32251048, 0.92020613,
         0.218864232, 0.324529231, -0.785796642, 0.424246997, -0.450042367,
         0.11695727, 0.261626512, 0.347467005, 0.71889019, -0.324269891,
         -0.586965024, -0.741836369, 0.0190161243, 0.0701182857},
        {0.398425221, 0.117996328, 0.26188308, 1.41756487, 0.205550998,
         -0.591711998, 0.779503524, -0.125116929, 0.332026005, -0.93493557,
         0.326473951, 2.91732669, 0.022422554, 0.901470721, -0.154502422,
         0.418840766, 0.8948192, 0.107503168, 0.91941458},
        {-0.624053597, 0.642548203, 0.718474627, 6.60767651, 0.244059786,
         -0.225159615, -0.943259239, 0.964667737, 0.253644705, 0.0712777376,
         0.0566169061, 0.0759533346, 0.054969091, 0.85545218, -0.212717712,
         0.370607316, -0.904102564, 0.0109555265, 0.186422274},
        {0.553411365, 0.658103585, 0.891951263, 0.348451644, 0.490238816,
         -0.534969389, 0.688094199, -0.235622793, -0.277731597, -0.931314707,
         0.109118737, 0.197749138, 0.962392688, 0.762407959, -0.760219991,
         0.649427474, -0.0175938178, 4.66129398, 0.159582555},
        {0.97450459, 0.324549824, 0.56718117, 6.41624546, 0.802660823,
         -0.164555222, -0.573286295, -0.600782871, 0.233657047, 0.764502645,
         0.373567641, 0.590248525, 0.338468969, 0.688594639, -0.688172936,
         0.359425038, 0.63026309, 0.387809515, 0.50515765},
        {0.640163302, 0.167391241, 0.112509757, 6.24069023, -0.692170084,
         -0.0512578487, 0.719911933, -0.213471815, -0.969810605, -0.117886186,
         4.57200557e-22, 6.58531592e-22, 0.321237326, 0.491668522, 0.690171063,
         0.711063802, 0.134358346, 6.68439531, 10.9732122},
        {-0.95242691, 0.701310575, 0.250104696, 6.96303082, -0.764690936,
         0.586404502, -0.26716578, -0.89139086, -0.196424097, 0.408460379,
         0.369204611, 0.426896572, 0.717683375, 0.96765995, 0.85332334,
         -0.33311379, 0.401091635, 1.01164746, 1.14862537},
        {0.281852722, 0.697995186, 0.665344775, 2.04725695, -0.240301877,
         -0.785744846, 0.569965005, -0.672043085, -0.739808798, -0.0322674513,
         0.0695118085, 0.0360038392, 0.806749225, 0.46064049, 0.172512442,
         -0.703872502, 0.689059496, 0.0176090859, 0.194768637},
        {0.467767954, 0.975943625, 0.795990705, 4.42211819, 0.729317009,
         0.655731857, 0.195224106, 0.963777423, 0.26556924, -0.0246186256,
         0.447613716, 0.154629871, 0.248995587, 0.516886353, -0.0642586648,
         0.769704819, -0.635157704, 0.0226719566, 0.202067673},
        {0.63950634, 0.878258467, 0.74834764, 4.12158823, -0.0422869734,
         0.0431978405, -0.99817121, 0.738112986, -0.385028064, -0.554023981,
         0.0143055674, 0.149723187, 0.162174866, 0.332817912, 0.372150838,
         -0.927961528, -0.0197774135, 0.596459091, 0.222846434},
        {0.393319249, 0.700939596, 0.758266747, 0.257166982, -0.260993093,
         0.932646036, 0.249106407, -0.551248729, -0.78621453, 0.279269755,
         0.16379492, 0.0748692602, 0.0194257498, 0.512111962, -0.629741848,
         0.033264488, 0.776091933, 0.0129257841, 0.0164190941},
        {0.0697523355, 0.439436048, 0.873905778, 0.943072498, 0.0200928971,
         0.488899887, 0.872108459, 0.0530082509, -0.989135146, -0.137119651,
         0.404132754, 0.298539042, 0.290026605, 0.48517102, -0.105577148,
         -0.993080795, 0.0514191985, 0.972955287, 0.269522846},
        {-0.598011136, 0.868451357, 0.223186985, 5.01086569, -0.827163756,
         0.043262884, 0.560293138, -0.33209151, -0.943204165, 0.0090071559,
         0.609181285, 0.0472393818, 0.756874681, 0.410118043, -0.200284511,
         -0.918800831, 0.340133995, 0.518137753, 1.51727855},
        {0.72447753, 0.390529811, 0.143149212, 5.33214951, 0.32842195,
         0.481427968, 0.812629163, -0.25411436, 0.832416892, -0.492451072,
         0.579502642, 4.4676466, 0.505351305, 0.678389788, 0.361117542,
         0.778840542, -0.512836635, 0.20322302, 1.6315949},
        {0.918840528, 0.425190091, 0.842566669, 4.88407183, -0.255037695,
         -0.229572669, 0.939282775, -0.0280587655, 0.204090521, -0.978549838,
         0.0299112275, 0.191961139, 0.158470228, 0.481889874, 0.0308044106,
         0.703919768, -0.709611177, 0.0580789968, 0.270293564},
        {0.00269651413, 0.180361927, 0.138117895, 4.63086414, -0.82929486,
         0.47892049, -0.287932634, 0.897718906, -0.125770688, -0.422235012,
         8.51534843e-15, 4.44909748e-14, 0.133026779, 0.692560315, 0.819464326,
         0.481306642, -0.311162561, 6.84868813, 26.3699722},
        {0.43287468, 0.151535794, 0.851192832, 3.57975411, 0.120560646,
         0.0823985934, -0.989280343, 0.272439629, -0.95935601, 0.0735701323,
         0.00473739766, 0.00720420107, 0.867471457, 0.118081041, -0.0834455118,
         -0.196409538, -0.976964772, 0.0416142307, 0.840359747},
        {-0.0494582057, 0.848678052, 0.747971833, 4.05654907, -0.238067478,
         0.855342686, 0.460122585, 0.0565849692, 0.891711533, 0.449052989,
         0.0241553318, 0.231601626, 0.305565536, 0.279372811, 0.781163037,
         0.620113611, -0.072411567, 0.108219184, 0.16731821},
        {-0.502948046, 0.97925669, 0.871611118, 7.28320312, 0.934945405,
         0.211944059, -0.284529209, -0.863936365, 0.474647939, -0.168295264,
         0.185054839, 0.148091435, 0.92001754, 0.428619802, -0.6984303,
         -0.631972015, 0.335866809, 0.0197242144, 0.0315010026},
        {-0.00731021166, 0.744247317, 0.913674712, 6.89878845, 0.206287414,
         0.955436051, -0.21115768, -0.741393805, 0.388174623, -0.547408104,
         0.0101193897, 0.118986629, 0.58162415, 0.31529963, 0.405668855,
         0.914015174, -0.00300344126, 1.72530162, 0.111305542},
        {-0.0866311789, 0.861003518, 0.723169863, 0.489634275, 0.731950521,
         -0.154137328, 0.663694263, -0.918582737, 0.347044975, 0.18911773,
         0.12928094, 0.0684389248, 0.812152505, 0.949215174, -0.447295099,
         0.678107977, -0.583178103, 0.139909297, 0.228393793},
        {0.597730279, 0.569315791, 0.658823073, 5.03516769, -0.0960659012,
         -0.444812119, 0.890456915, -0.335057229, -0.866544783, -0.369914532,
         0.000296603364, 0.00215869001, 0.514671683, 0.908942103, 0.694357097,
         0.435197502, 0.57312417, 0.0242391396, 0.273324639},
        {0.964997172, 0.941134214, 0.401380509, 3.30666733, 0.0889959559,
         0.00648133038, -0.9960109, -0.803322971, -0.157829344, 0.574249148,
         0.18860358, 0.413409621, 0.481176019, 0.367112845, -0.0120831355,
         -0.489378035, 0.871988058, 0.197775945, 0.658285677},
        {-0.407264531, 0.756901145, 0.821343005, 5.76325417, 0.535401702,
         -0.841818869, 0.0684545636, -0.910878062, -0.406535536, 0.070922792,
         0.125794902, 0.170768127, 0.26838696, 0.360063463, -0.255531549,
         -0.372862011, 0.892007649, 0.00263340259, 0.0449618101},
        {-0.247110367, 0.346831739, 0.854819477, 4.36014557, -0.911410987,
         0.123628035, -0.392487168, -0.0184699073, -0.762966573, 0.646174073,
         7.53461936e-05, 0.000342935702, 0.243424654, 0.500399232, 0.0915076137,
         0.572311163, -0.814914882, 0.0016515014, 0.00947966613},
        {-0.0364052653, 0.721671164, 0.944460273, 1.67640257, 0.955307186,
         0.28779605, 0.0675392151, -0.697463453, 0.683347702, 0.215825737,
         0.181786224, 0.17070359, 0.526708186, 0.665507853, 0.844341516,
         0.372818708, 0.384829313, 0.0190600641, 0.0319132395},
        {0.38320601, 0.62409097, 0.829537988, 3.50471282, 0.430869788,
         0.414421141, 0.801627338, -0.723868012, 0.237523645, -0.64776361,
         0.00743991137, 0.0965085328, 0.866705835, 0.609141171, -0.247664392,
         0.67020613, 0.699632823, 0.0141528156, 0.1982871},
        {0.704447627, 0.187777549, 0.688448429, 5.45473433, -0.979883134,
         -0.189185023, 0.0635461807, 0.868006647, 0.441444844, -0.227356315,
         0.131547853, 0.0643444955, 0.421600997, 0.572053552, 0.90349251,
         0.135839865, 0.406508058, 1.81714249, 1.58920074},
        {-0.922044754, 0.652133763, 0.59358573, 1.25939548, 0.277454615,
         -0.481377333, 0.831441402, -0.383438289, 0.384192675, 0.839863718,
         0.0139259668, 0.0470856838, 0.166398302, 0.462928414, -0.478133082,
         -0.262985677, -0.837990046, 0.0819564685, 0.276488245},
        {0.0827840567, 0.91499871, 0.326911449, 7.13353634, -0.0860487372,
         -0.569337964, -0.817587852, -0.575176239, -0.661393166, 0.481384873,
         8.66811388e-06, 8.96877536e-05, 0.0187065415, 0.813847065,
         -0.678860068, -0.682345092, -0.271208912, 0.0255083293, 0.148696855},
        {-0.523753643, 0.307263881, 0.961873829, 7.38602972, -0.377316922,
         0.0377602205, -0.925314069, 0.433196336, -0.8829, -0.181186438,
         0.056194514, 0.198777825, 0.599419951, 0.301806003, 0.517836332,
         0.794322014, 0.317644566, 0.037914712, 0.235124335},
        {-0.0985231996, 0.465318173, 0.460699886, 1.33433497, 0.517635286,
         0.0984645709, -0.849916697, -0.958588183, 0.135173947, -0.250672579,
         0.122678697, 0.3005144, 0.291569084, 0.345641702, -0.429551989,
         0.0732016936, 0.90007031, 0.0740359351, 0.651190698},
        {0.0881084204, 0.985606849, 0.849685729, 6.60206842, -0.989043951,
         0.0828681737, -0.122167587, -0.82586354, 0.562085569, -0.0448247194,
         1.03261757, 0.102364078, 0.328378916, 0.484573275, 0.705161035,
         -0.365043581, 0.607857823, 0.0100534828, 0.0135147842},
        {0.044131279, 0.519065797, 0.666865289, 1.08843374, -0.898762167,
         -0.358834893, -0.2519207, 0.658211946, 0.745593667, -0.104149342,
         0.177087024, 0.105100587, 0.178903103, 0.236477077, 0.308111459,
         -0.885448456, -0.347920001, 0.097731404, 0.193764985},
        {0.371180892, 0.81983304, 0.766635835, 7.72040749, 0.977572262,
         0.208364204, -0.030608058, -0.847131729, 0.484648764, 0.217907012,
         0.191802919, 0.117827885, 0.847116709, 0.640422702, 0.690539539,
         0.631434083, -0.352769315, 0.114687227, 0.114058472},
        {0.956157923, 0.785808623, 0.959045827, 2.59632015, -0.146754891,
         0.979656398, -0.136880517, 0.603112221, 0.796629965, 0.0404520631,
         0.407225162, 0.0695671514, 0.367273957, 0.0905287787, 0.845546365,
         -0.145000815, 0.513834715, 0.0376928486, 0.0817921013},
        {0.177923203, 0.415092707, 0.916951716, 5.31694174, 0.986334741,
         -0.0117014935, 0.164337456, -0.878870189, -0.426098913, -0.214538574,
         0.589170337, 0.301724315, 0.469598591, 0.310155392, -0.910768092,
         0.277039737, 0.306186944, 0.966474831, 0.706384599},
        {-0.474114835, 0.988578796, 0.426235676, 7.0721693, -0.880980134,
         0.458557248, 0.116615355, -0.325582236, 0.912926376, -0.246092796,
         0.000901230029, 0.0016775761, 0.0269775707, 0.392558277, 0.254551917,
         0.659876764, 0.706941307, 0.0473683625, 0.253290892},
        {-0.166869283, 0.149932265, 0.712322116, 5.73359919, -0.969951212,
         -0.230633959, 0.0774770379, 0.916196465, 0.166116387, -0.364677072,
         0.124556519, 0.158660427, 0.834655583, 0.118029073, 0.966486335,
         -0.254368842, -0.0346500836, 52.997673, 6.4143815},
        {-0.333508074, 0.192239121, 0.815971196, 2.65196824, -0.0433632582,
         -0.585811377, 0.809286535, 0.0715824515, -0.959638238, -0.271974921,
         0.134344816, 0.704160213, 0.294412524, 0.169331849, -0.28464064,
         -0.378738075, 0.880645931, 0.00477615511, 0.0810590386},
        {-0.9074108, 0.852193832, 0.778664887, 7.33907366, -0.187587857,
         -0.506080925, -0.841838956, -0.998257577, 0.0545523204, 0.0224896073,
         1.04875457, 0.175737664, 0.409969717, 0.49580276, -0.269981414,
         0.962827384, -0.00857482944, 3.2093482, 0.205046058},
        {0.492945671, 0.620902717, 0.458270103, 7.43195868, -0.819289327,
         -0.572106659, -0.038197279, -0.230448723, -0.624261439, 0.746452332,
         0.0387987494, 0.296383977, 0.0757002831, 0.713684976, 0.721380115,
         -0.0224641357, 0.692174911, 0.0431105942, 0.305375725},
        {-0.23941201, 0.787623882, 0.916142106, 2.74532843, -0.994141877,
         -0.101417758, 0.0373675823, 0.199338645, -0.908379555, 0.367573977,
         0.180783689, 0.118156798, 0.639047563, 0.485445857, 0.875095785,
         0.149475902, -0.460287243, 0.166966736, 0.136651263},
        {0.23140955, 0.880218148, 0.218579397, 4.82880068, -0.42791158,
         0.691319644, -0.582210302, -0.472468257, 0.87193352, 0.128474355,
         2.87555206e-08, 7.72155957e-08, 0.199304581, 0.630342424, -0.227413967,
         0.33207041, -0.915430009, 0.0755092353, 1.44474947},
        {-0.756742477, 0.344029278, 0.745815754, 3.14578772, -0.694549084,
         0.0499083214, -0.717712164, 0.062661238, -0.890445888, -0.450754523,
         0.000416762952, 0.00172012474, 0.97262311, 0.56884867, 0.248450249,
         -0.0447743014, 0.967609286, 0.00646948861, 0.057319276},
        {-0.433344543, 0.965296984, 0.794753432, 0.778353155, 0.210820585,
         -0.226637244, 0.95088917, -0.922893286, 0.379484326, 0.0652658343,
         0.316179544, 0.0824966803, 0.373022825, 0.46499002, -0.384862006,
         0.648695529, 0.656563342, 0.0161038544, 0.0422691293},
        {0.962397575, 0.746147513, 0.895468354, 5.92473459, 0.194970712,
         -0.980349541, -0.0300186872, -0.733099163, 0.678269804, 0.0501567721,
         0.686416507, 0.136213183, 0.553997159, 0.45549649, -0.291692555,
         0.333803684, 0.896376371, 0.0377061069, 0.13372229},
        {0.00979149342, 0.544251561, 0.509889543, 0.530777872, -0.214988887,
         0.46155867, -0.860664487, 0.335381389, -0.334840745, 0.880568564,
         0.370505005, 0.899214923, 0.743082285, 0.757972598, -0.117332116,
         -0.983941078, 0.134510532, 0.19313848, 0.0716030374},
        {-0.894384861, 0.353470564, 0.122724555, 7.39607906, 0.179762065,
         0.735473275, 0.653272271, 0.177969903, -0.981605649, 0.0691164136,
         0.598182082, 0.342322379, 0.817905605, 0.554078877, -0.438100815,
         -0.881237984, 0.177446574, 4.86157131, 7.14273882},
        {0.094498992, 0.167901799, 0.603891432, 1.20015192, -0.291408658,
         -0.955305815, -0.0497175455, -0.518207967, -0.711763203, -0.474187374,
         8.92039043e-06, 3.3500939e-05, 0.187842846, 0.0393906683, 0.404358625,
         -0.786119461, 0.467450768, 0.107190937, 0.396841347},
        {0.878611565, 0.455616206, 0.846254468, 6.57977962, 0.346741021,
         0.811548531, -0.470276117, 0.344118774, -0.619403124, -0.705635905,
         0.0180821754, 0.108831123, 0.426759183, 0.964149117, -0.232277155,
         -0.968265235, -0.0922479555, 0.343734652, 0.270459205},
        {-0.891767442, 0.218902379, 0.148097843, 7.3800621, 0.938752234,
         -0.225656107, -0.260429502, 0.0333179794, 0.783243239, -0.620821953,
         8.38245705e-13, 1.20395057e-12, 0.0935919657, 0.175528347,
         -0.989408135, 0.143140838, -0.0241298936, 262.421448, 14.6495714},
        {-0.423105597, 0.87293303, 0.259800613, 4.45756197, 0.928719938,
         -0.0920814201, -0.359166145, -0.818546355, 0.274249673, -0.504746437,
         0.438773841, 1.19863081, 0.216914758, 0.999224484, -0.823880315,
         0.303593785, -0.478593826, 0.640824556, 1.65988386},
        {0.921184063, 0.196619809, 0.617044508, 5.95250034, -0.996878326,
         -0.0424403474, -0.0665767193, 0.888434827, -0.0593243353, 0.455152929,
         1.23730409, 0.670193136, 0.642875612, 0.399348766, 0.976547897,
         -0.144775972, 0.159355417, 33.9678459, 6.44170761},
        {-0.973083138, 0.366809964, 0.873524845, 1.32996655, 0.21712251,
         -0.525601983, -0.822557211, -0.475719601, 0.87958473, 0.00463777781,
         16.9682178, 0.213925391, 0.155058414, 0.22405605, -0.573354006,
         0.817465246, 0.0549166091, 1.13470638, 0.169396058},
        {-0.343052566, 0.543092966, 0.635631979, 3.64720201, 0.194362342,
         0.778737903, -0.5964818, -0.870692492, -0.394148052, 0.294180214,
         0.000498684589, 0.00307446532, 0.081916064, 0.914686918, 0.516332448,
         0.386511832, -0.764205158, 0.00316545973, 0.0506963804},
        {-0.532591939, 0.604633987, 0.577117205, 6.58921099, -0.435409278,
         -0.38610962, 0.813226998, -0.76610738, -0.634418607, 0.102920055,
         0.0745562166, 0.145197526, 0.172975421, 0.312853903, 0.824458241,
         -0.557964027, 0.0945767537, 0.273919553, 0.490210652},
        {0.11305654, 0.694917917, 0.406487882, 6.21860123, -0.693955541,
         0.71719718, -0.0636698008, -0.170142695, 0.980871379, -0.0945664644,
         0.233041123, 0.390012175, 0.896499395, 0.0285156537, 0.653683186,
         0.755019963, -0.0514123179, 0.745610178, 0.678402483},
    };
    int count = sizeof(v) / sizeof(v[0]);
    for (int i = 0; i < count; ++i) {
        Float h = v[i][0];
        Float beta_m = v[i][1];
        Float beta_n = v[i][2];
        Float sig = v[i][3];
        Vector3f wo(v[i][4], v[i][5], v[i][6]);
        Vector3f wi(v[i][7], v[i][8], v[i][9]);
        Float f = v[i][10];
        Float pdf = v[i][11];

        HairBSDF hair(h, 1.55, sig, beta_m, beta_n, 0.f);

        // relative error
        auto re = [](Float a, Float b) { return std::abs((a - b) / b); };
        EXPECT_LT(re(hair.f(wo, wi).y(), f), 1e-5);
        EXPECT_LT(re(hair.Pdf(wo, wi), pdf), 1e-5);

        Point2f u = {v[i][12], v[i][13]};
        Vector3f wis;
        Float pdfs;
        Float fs = hair.Sample_f(wo, &wis, u, &pdfs, nullptr).y();
        EXPECT_LT(re(wis.x, v[i][14]), 1e-5) << wis.x << " vs " << v[i][14]
                                             << " @ i = " << i;
        EXPECT_LT(re(wis.y, v[i][15]), 1e-5) << wis.y << " vs " << v[i][15]
                                             << " @ i = " << i;
        EXPECT_LT(re(wis.z, v[i][16]), 1e-5) << wis.z << " vs " << v[i][16]
                                             << " @ i = " << i;
        EXPECT_LT(re(fs, v[i][17]), 1e-5) << fs << " vs " << v[i][17]
                                          << " @ i = " << i;
        EXPECT_LT(re(pdfs, v[i][18]), 1e-5) << pdfs << " vs " << v[i][18]
                                            << " @ i = " << i;
    }
}
